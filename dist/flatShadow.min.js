class FlatShadow{constructor(t,e){t?(this._internalDefaults={angle:45,color:this._calulateColor(t),blur:0,shadowLength:1e3,step:2,trackingEnabled:!1,hover:!1,forceText:!1,debug:!1},this._shadowAttributes=Object.assign({},this._internalDefaults,e,this._parseTargetForAttributes(t)),this.targetElement=t,this._fsid=this._createUUID(),this.targetElement.setAttribute("fsid",this._fsid),this._dataURL=document.createElement("link"),this._dataURL.rel="stylesheet",this._dataURL.setAttribute("fsid",this._fsid),document.head.appendChild(this._dataURL),this._shadowAttributes.forceText||(this._shadowAttributes.forceText=this._checkForTextNode(this.targetElement)),this._shadowAttributes.trackingEnabled&&window.matchMedia("@media(any-hover:none)").matches&&(this._shadowAttributes.trackingEnabled=!1,this._shadowAttributes.debug&&console.warn('FlatShadow: Tracking shadows are disabled on touch and stylus devices for compatability reasons. trackingEnabled was set to "false".')),this._renderShadow(),this._shadowAttributes.trackingEnabled&&(this._isCurrentlyVisible=this._checkForVisibilty(),window.addEventListener("mousemove",t=>{this._trackShadow(t)}),window.addEventListener("scroll",t=>{this._updateElementOnScroll()})),this._shadowAttributes.debug&&console.log(this)):console.error("FlatShadow: No target has been given.")}_parseTargetForAttributes(s){const i={};return["angle","color","blur","shadowLength","step","trackingEnabled","hover","forceText","debug"].forEach(t=>{let e=s.getAttribute(`flatshadow-${t}`);null!=e&&null!=e&&(e.match(/[0-9]+$/gim)&&(e=parseInt(e)),i[t]=e)}),i}_checkForTextNode(t){let e=!0;return t.childNodes.forEach(t=>{3!=t.nodeType&&(e=!1)}),0===t.childNodes.length&&(e=!1),e}_calulateColor(t){t=t.parentElement;const e=window.getComputedStyle(t).backgroundColor;t=e.match(/\d+/gim);return`rgba(${t[0]-10}, ${t[1]-10}, ${t[2]-10}, 0.3)`}_renderShadow(){const t=()=>{let e=`0px 0px 0px ${this._shadowAttributes.color}`;var t=this._shadowAttributes.angle,s=this._shadowAttributes.shadowLength,i=this._shadowAttributes.step,a=this._shadowAttributes.blur,h=this._shadowAttributes.color,o=Math.sin(t*(Math.PI/180)).toFixed(2),r=Math.cos(t*(Math.PI/180)).toFixed(2);for(let t=0;t<s;t+=i)e+=`, ${t*o}px ${t*r}px ${a}px ${h}`;return e};var e=btoa(`*[fsid="${this._fsid}"]${this._shadowAttributes.hover?":hover":""} {
                ${this._shadowAttributes.forceText?"text-shadow: ":"box-shadow: "}${t()};
            }`);this._dataURL.href=`data:text/css;base64,${e}`}_updateElementOnScroll(){this._elementDimension=this.targetElement.getBoundingClientRect(),this._isCurrentlyVisible=this._checkForVisibilty()}_checkForVisibilty(){let t=!0;this._elementDimension||(this._elementDimension=this.targetElement.getBoundingClientRect());var{top:e,bottom:s}=this._elementDimension;return(s<0||e>window.innerHeight)&&(t=!1),t}_trackShadow(t){var e,s,i,a;this._isCurrentlyVisible&&(e={x:t.clientX,y:t.clientY},{top:i,left:s,width:a,height:t}=this._elementDimension,a={x:(s={x:s+a/2,y:i+t/2}).x,y:e.y},t=(i=(t,e)=>Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)))(e,s),a=i(s,a),t=Math.acos(a/t)*(180/Math.PI),this._shadowAttributes.angle=e.y<s.y?e.x<s.x?t:-1*t+360:e.x<s.x?-1*t+180:t-180,window.requestAnimationFrame(this._renderShadow.bind(this)))}_createUUID(){var e="aAbBcCdDeEfFgGhHiIjJkKlLmMnNoOpPqQrRsStTuUvVwWxXyYzZ0123456789";let s=[];for(let t=0;t<12;t++)s.push(e[Math.floor(+Math.random())*e.length]);return s.join("")}set angle(t){this._shadowAttributes.angle=t,this._renderShadow()}set color(t){this._shadowAttributes.color=color,this._renderShadow()}set blur(t){this._shadowAttributes.blur=t,this._renderShadow()}set step(t){this._shadowAttributes.step=t,this._renderShadow()}set shadowLength(t){this._shadowAttributes.shadowLength=t,this._renderShadow()}set hover(t){this._shadowAttributes.hover=t,this._renderShadow()}}window.addEventListener("DOMContentLoaded",t=>{document.querySelectorAll(".flatShadow").forEach(t=>new FlatShadow(t))});