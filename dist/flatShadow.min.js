class FlatShadow{constructor(t,e){t?(this._internalDefaults={angle:45,color:this._calulateColor(t),blur:0,shadowLength:1e3,step:2,trackingEnabled:!1,hover:!1,forceText:!1,debug:!1},this._shadowAttributes=Object.assign({},this._internalDefaults,e,this._parseTargetForAttributes(t)),this.targetElement=t,this._fsid=this._createUUID(),this.targetElement.setAttribute("fsid",this._fsid),this._dataURL=document.createElement("link"),this._dataURL.rel="stylesheet",this._dataURL.setAttribute("fsid",this._fsid),document.head.appendChild(this._dataURL),this._shadowAttributes.forceText||(this._shadowAttributes.forceText=this._checkForTextNode(this.targetElement)),this._shadowAttributes.trackingEnabled&&window.matchMedia("@media(any-hover:none)").matches&&(this._shadowAttributes.trackingEnabled=!1,this._shadowAttributes.debug&&console.warn('FlatShadow: Tracking shadows are disabled on touch and stylus devices for compatability reasons. trackingEnabled was set to "false".')),this._renderShadow(),this._shadowAttributes.trackingEnabled&&this._createTracker(),this._shadowAttributes.debug&&console.log(this)):console.error("FlatShadow: No target has been given.")}_parseTargetForAttributes(s){const a={};return["angle","color","blur","shadowLength","step","trackingEnabled","hover","forceText","debug"].forEach(t=>{let e=s.getAttribute(`flatshadow-${t}`);null!=e&&null!=e&&(isNaN(parseFloat(e))||(e=parseFloat(e)),a[t]=e)}),a}_checkForTextNode(t){let e=!0;return t.childNodes.forEach(t=>{3!=t.nodeType&&(e=!1)}),0===t.childNodes.length&&(e=!1),e}_calulateColor(t){t=t.parentElement;const e=window.getComputedStyle(t).backgroundColor;t=e.match(/\d+/gim);return`rgba(${t[0]-10}, ${t[1]-10}, ${t[2]-10}, 0.3)`}_renderShadow(){const t=()=>{let e=`0px 0px 0px ${this._shadowAttributes.color}`;var t=this._shadowAttributes.angle,s=this._shadowAttributes.shadowLength,a=this._shadowAttributes.step,r=this._shadowAttributes.blur,i=this._shadowAttributes.color,o=Math.sin(t*(Math.PI/180)).toFixed(2),h=Math.cos(t*(Math.PI/180)).toFixed(2);for(let t=0;t<s;t+=a)e+=`, ${t*o}px ${t*h}px ${r}px ${i}`;return e};var e=btoa(`*[fsid="${this._fsid}"]${this._shadowAttributes.hover?":hover":""} {
                ${this._shadowAttributes.forceText?"text-shadow: ":"box-shadow: "}${t()};
            }`);this._dataURL.href=`data:text/css;base64,${e}`}_updateElementOnScroll(){this._elementDimension=this.targetElement.getBoundingClientRect(),this._isCurrentlyVisible=this._checkForVisibilty()}_checkForVisibilty(){let t=!0;this._elementDimension||(this._elementDimension=this.targetElement.getBoundingClientRect());var{top:e,bottom:s}=this._elementDimension;return(s<0||e>window.innerHeight)&&(t=!1),t}_createTracker(){this._tracker||(this._tracker={},this._tracker.move=window.addEventListener("mousemove",t=>{this._trackShadow(t)}),this._tracker.scroll=window.addEventListener("scroll",t=>{this._updateElementOnScroll()}),this._trackerEnabled=!0)}_removeTracker(){this._trackers&&(window.removeEventListener("mousemove",this._tracker.move),window.removeEventListener("scroll",this._tracker.scroll),this._trackers=void 0)}_trackShadow(t){var e,s,a,r;this._isCurrentlyVisible&&(e={x:t.clientX,y:t.clientY},{top:a,left:s,width:r,height:t}=this._elementDimension,r={x:(s={x:s+r/2,y:a+t/2}).x,y:e.y},t=(a=(t,e)=>Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)))(e,s),r=a(s,r),t=Math.acos(r/t)*(180/Math.PI),this._shadowAttributes.angle=e.y<s.y?e.x<s.x?t:-1*t+360:e.x<s.x?-1*t+180:t-180,window.requestAnimationFrame(this._renderShadow.bind(this)))}_createUUID(){var e="aAbBcCdDeEfFgGhHiIjJkKlLmMnNoOpPqQrRsStTuUvVwWxXyYzZ0123456789";let s=[];for(let t=0;t<12;t++)s.push(e[+Math.floor(Math.random()*e.length)]);return s.join("")}_setValue(t,e){isNaN(parseFloat(e))?this._shadowAttributes.debug&&console.warn(`FlatShadow: ${e} for ${t} is not an Integer or Float. This value should be parseable to type Number.`):(this._shadowAttributes[t]=parseFloat(Math.abs(e)),this._renderShadow())}set angle(t){this._setValue("angle",t)}set color(t){this._shadowAttributes.color=t,this._renderShadow()}set blur(t){this._setValue("blur",t)}set step(t){0!=t?this._setValue("step",t):this._shadowAttributes.debug&&console.warn(`FlatShadow: Step should not be set to ${t}.`)}set shadowLength(t){this._setValue("shadowLength",t)}set hover(t){this._shadowAttributes.hover=t,this._renderShadow()}set trackingEnabled(t){(this._shadowAttributes.trackingEnabled=t)?this._createTracker():this._removeTracker()}}window.addEventListener("DOMContentLoaded",t=>{document.querySelectorAll(".flatShadow").forEach(t=>new FlatShadow(t))});